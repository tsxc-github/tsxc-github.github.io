document.addEventListener("DOMContentLoaded",(()=>{if(!navigator.serviceWorker?.controller)return;const e=e=>{const t=e.endsWith("js")?"script":"link",o="link"===t?"href":"src";for(let r of document.getElementsByTagName(t)){const n=r[o];if(e.length>n?e.endsWith(n):n.endsWith(e)){const e=document.createElement(t),o=r.text||r.textContent||r.innerHTML||"";return Array.from(r.attributes).forEach((t=>e.setAttribute(t.name,t.value))),e.appendChild(document.createTextNode(o)),r.parentNode.replaceChildren(e,r),!0}}},t="updated";var o;sessionStorage.getItem(t)?sessionStorage.removeItem(t):(o="update",navigator.serviceWorker.controller.postMessage(o)),navigator.serviceWorker.addEventListener("message",(o=>{const r=o.data;sessionStorage.setItem(t,r.type);const n=r.list?.filter((e=>/\.(js|css)$/.test(e)));if(n)window.Pjax?.isSupported?.()&&n.forEach(e),location.reload();else{const e=r.new,o=r.old;o&&(e.global!==o.global||(e.local,o.local)),sessionStorage.removeItem(t)}}))}));